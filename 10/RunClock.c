/*********************************************************************************************************
* 模块名称: 
* 摘    要: 
* 当前版本: 
* 作    者: 
* 完成日期:  
* 内    容:
* 注    意:                                                                   
**********************************************************************************************************
* 取代版本: 
* 作    者:
* 完成日期: 
* 修改内容:
* 修改文件: 
*********************************************************************************************************/

/*********************************************************************************************************
*                                              包含头文件
*********************************************************************************************************/
#include <stdio.h>

#include "RunClock.h"
/*********************************************************************************************************
*                                              宏定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              枚举结构体定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              内部变量
*********************************************************************************************************/
 static i16 s_iHour;
 static i16 s_iMin;
 static i16 s_iSec;

static u8 s_iClockPauseFlag = 0;

/*********************************************************************************************************
*                                              内部函数声明
*********************************************************************************************************/

/*********************************************************************************************************
*                                              内部函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称: 
* 函数功能:  
* 输入参数: 
* 输出参数: 
* 返 回 值: 
* 创建日期: 
* 注    意:
*********************************************************************************************************/

/*********************************************************************************************************
*                                              API函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称: 
* 函数功能:  
* 输入参数: 
* 输出参数: 
* 返 回 值: 
* 创建日期: 
* 注    意:
*********************************************************************************************************/
void InitRunClock(void) {
    s_iHour = 0;
    s_iMin = 0;
    s_iSec = 0;
}

/*********************************************************************************************************
* 函数名称:
* 函数功能:
* 输入参数:
* 输出参数:
* 返 回 值:
* 创建日期:
* 注    意:
*********************************************************************************************************/
void RunClockPer2Ms(void) {
    static i16 s_iCnt500 = 0;

    if(499 <= s_iCnt500 && 0 == s_iClockPauseFlag) {
        if(59 <= s_iSec) {
            s_iSec = 0;
            if(59 <= s_iMin) {
                if(23 <= s_iHour) {
                    s_iHour = 0;
                }
                else {
                    s_iHour++;
                }
                s_iMin = 0;
            }
            else {
                s_iMin++;
            }
        }
        else {
            s_iSec++;
        }
        s_iCnt500 = 0;
    }
    else {
        s_iCnt500++;
    }
}

/*********************************************************************************************************
* 函数名称:
* 函数功能:
* 输入参数:
* 输出参数:
* 返 回 值:
* 创建日期:
* 注    意:
*********************************************************************************************************/
void PauseClock(u8 flag) {
    s_iClockPauseFlag = flag;
}

/*********************************************************************************************************
* 函数名称:
* 函数功能:
* 输入参数:
* 输出参数:
* 返 回 值:
* 创建日期:
* 注    意:
*********************************************************************************************************/
i16 GetTimeVal(u8 type) {
    i16 timeVal;

    switch (type) {
        case TIME_VAL_HOUR:
            timeVal = s_iHour;
            break;
        case TIME_VAL_MIN:
            timeVal = s_iMin;
            break;
        case TIME_VAL_SEC:
            timeVal = s_iSec;
            break;
        default:
            break;
    }

    return (timeVal);
}

/*********************************************************************************************************
* 函数名称:
* 函数功能:
* 输入参数:
* 输出参数:
* 返 回 值:
* 创建日期:
* 注    意:
*********************************************************************************************************/
void SetTimeVal(u8 type, i16 timeVal) {
    switch (type) {
        case TIME_VAL_HOUR:
            s_iHour = timeVal;
            break;
        case TIME_VAL_MIN:
            s_iMin = timeVal;
            break;
        case TIME_VAL_SEC:
            s_iSec = timeVal;
            break;
        default:
            break;
    }
}

/*********************************************************************************************************
* 函数名称:
* 函数功能:
* 输入参数:
* 输出参数:
* 返 回 值:
* 创建日期:
* 注    意:
*********************************************************************************************************/
void DispTime(i16 hour, i16 min, i16 sec) {
    printf("Now is %02d:%02d:%02d\n", hour, min, sec);
}
